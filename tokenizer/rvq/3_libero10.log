[robosuite WARNING] No private macro file found! (__init__.py:7)
WARNING:robosuite_logs:No private macro file found!
[robosuite WARNING] It is recommended to use a private macro file (__init__.py:8)
WARNING:robosuite_logs:It is recommended to use a private macro file
[robosuite WARNING] To setup, run: python /venv/main/lib/python3.12/site-packages/robosuite/scripts/setup_macros.py (__init__.py:9)
WARNING:robosuite_logs:To setup, run: python /venv/main/lib/python3.12/site-packages/robosuite/scripts/setup_macros.py
Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
================================================================================
RVQ COMPRESSION ANALYSIS
================================================================================

[1/3] Loading trained RVQ model...
‚úì Loaded RVQ tokenizer from rvq_tokenizer.pt
  Config: {'action_dim': 7, 'chunk_size': 10, 'num_layers': 8, 'hidden_dim': 64, 'num_embeddings': 256}

[2/3] Collecting test actions...
================================================================================
COLLECTING œÄ0.5 ACTIONS ON LIBERO
================================================================================

[1/4] Loading œÄ0.5 policy...
‚úì PyTorch checkpoint already exists: /root/.cache/openpi/converted_checkpoints/pi05_libero_pytorch
  Use --force_conversion to re-convert

Loading pi05-libero policy from: /root/.cache/openpi/converted_checkpoints/pi05_libero_pytorch
Creating policy with pi05_libero configuration...
/venv/main/lib/python3.12/site-packages/torch/jit/_script.py:365: DeprecationWarning: `torch.jit.script_method` is deprecated. Please switch to `torch.compile` or `torch.export`.
  warnings.warn(
‚úì Policy loaded successfully!

GPU Memory Usage:
  Allocated: 7.49 GB
  Reserved: 7.52 GB

[2/4] Loading LIBERO task: libero_10 - Task 0
[info] using task orders [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[Warning]: datasets path /workspace/basic-run/LIBERO/libero/libero/../datasets does not exist!
  Task: LIVING_ROOM_SCENE2_put_both_the_alphabet_soup_and_the_tomato_sauce_in_the_basket
  Description: put both the alphabet soup and the tomato sauce in the basket
  Initial states: 50

[3/4] Creating LIBERO environment...
[Warning]: datasets path /workspace/basic-run/LIBERO/libero/libero/../datasets does not exist!

[4/4] Collecting actions from 20 episodes...
/venv/main/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py:2033: UserWarning: Dynamo does not know how to trace the builtin `builtins.__build_class__.` This function is either a Python builtin (e.g. _warnings.warn) or a third-party C/C++ Python extension (perhaps created with pybind).
If it is a Python builtin, please file an issue on GitHub so the PyTorch team can add support for it and see the next case for a workaround.
If it is a third-party C/C++ Python extension, please either wrap it into a PyTorch-understood custom operator (see https://pytorch.org/tutorials/advanced/custom_ops_landing_page.html for more details) or, if it is traceable, use `torch.compiler.allow_in_graph`.
  torch._dynamo.utils.warn_once(explanation + "\n" + "\n".join(hints))

  [DEBUG] First action_chunk shape: (10, 7)
  [DEBUG] action_chunk dtype: float64
  [DEBUG] action_chunk type: <class 'numpy.ndarray'>
  Episode 1/20: ‚úÖ (steps: 353)
  Episode 2/20: ‚úÖ (steps: 289)
  Episode 3/20: ‚úÖ (steps: 284)
  Episode 4/20: ‚úÖ (steps: 385)
  Episode 5/20: ‚úÖ (steps: 414)
  Episode 6/20: ‚úÖ (steps: 275)
  Episode 7/20: ‚úÖ (steps: 350)
  Episode 8/20: ‚úÖ (steps: 264)
  Episode 9/20: ‚úÖ (steps: 272)
  Episode 10/20: ‚úÖ (steps: 246)
  Episode 11/20: ‚úÖ (steps: 296)
  Episode 12/20: ‚úÖ (steps: 335)
  Episode 13/20: ‚úÖ (steps: 295)
  Episode 14/20: ‚úÖ (steps: 291)
  Episode 15/20: ‚úÖ (steps: 342)
  Episode 16/20: ‚úÖ (steps: 293)
  Episode 17/20: ‚úÖ (steps: 287)
  Episode 18/20: ‚úÖ (steps: 294)
  Episode 19/20: ‚ùå (steps: 520)
  Episode 20/20: ‚úÖ (steps: 334)

‚úÖ Collected 6219 action chunks
   Success rate: 95.0%
   Avg episode length: 320.9 steps

[3/3] Analyzing compression...

================================================================================
ANALYZING RVQ COMPRESSION
================================================================================

Layers=1:
  MSE: 0.084810 ¬± 0.047306
  Tokens: 10.0
  Compression: 28.00x

Layers=2:
  MSE: 0.012996 ¬± 0.014246
  Tokens: 20.0
  Compression: 14.00x

Layers=3:
  MSE: 0.006011 ¬± 0.007100
  Tokens: 30.0
  Compression: 9.33x

Layers=4:
  MSE: 0.003703 ¬± 0.004810
  Tokens: 40.0
  Compression: 7.00x

Layers=5:
  MSE: 0.003070 ¬± 0.004273
  Tokens: 50.0
  Compression: 5.60x

Layers=6:
  MSE: 0.002856 ¬± 0.004148
  Tokens: 60.0
  Compression: 4.67x

Layers=7:
  MSE: 0.002828 ¬± 0.004243
  Tokens: 70.0
  Compression: 4.00x

Layers=8:
  MSE: 0.002881 ¬± 0.004462
  Tokens: 80.0
  Compression: 3.50x

üìä Plot saved to rvq_compression_analysis.png

================================================================================
SUMMARY
================================================================================

‚úÖ Optimal setting: 2 RVQ layers
   MSE: 0.012996 ¬± 0.014246
   Compression: 14.00x
   Tokens per chunk: 20.0

üéØ Best compression with excellent MSE (<0.01):
   3 layers
   MSE: 0.006011
   Compression: 9.33x
   ‚Üí Coarse layers (1-3) capture key motion!

üìä Layer comparison:
   Layer 1-2 (coarse): MSE=0.012996
   Layer 1-8 (fine):   MSE=0.002881
   ‚Üí Improvement from fine layers: 77.8%

‚ö†Ô∏è  HYPOTHESIS NEEDS REVISION
   Layer 1-2 MSE = 0.012996 > 0.01
   ‚Üí May need more coarse layers or task-specific analysis

================================================================================
NEXT STEPS
================================================================================
‚úÖ RVQ compression analysis complete!

Based on results:
  ‚úÖ Ready for Phase 2: Train VLA policy to predict RVQ tokens
  ‚úÖ Ready for Phase 3: Implement adaptive inference
     - Use layers 1-3 for coarse prediction
     - Activate all layers when uncertainty is high
================================================================================

sys:1: DeprecationWarning: builtin type swigvarlink has no __module__ attribute
