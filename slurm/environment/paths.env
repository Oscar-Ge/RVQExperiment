#!/bin/bash
# Environment variables for RVQ experiment paths

# Project root (adjust to actual path on Great Lakes)
export RVQ_ROOT="/home/gecm/RVQExperiment"

# Data directories
export RVQ_DATA_DIR="${RVQ_ROOT}/data"
export RVQ_MODEL_DIR="${RVQ_ROOT}/models"
export RVQ_RESULTS_DIR="${RVQ_ROOT}/results"
export RVQ_LOG_DIR="${RVQ_ROOT}/logs"

# Hugging Face cache and token
export HF_HOME="${RVQ_ROOT}/.hf_cache"
export TRANSFORMERS_CACHE="${HF_HOME}"

# Read HF token from user's home directory
if [ -f ~/.hf_token ]; then
    export HF_TOKEN=$(cat ~/.hf_token)
    export HUGGINGFACE_TOKEN=$(cat ~/.hf_token)
fi

# LIBERO config
export LIBERO_FOLDER="${RVQ_DATA_DIR}/libero"
export LIBERO_NO_PROMPT="1"

# MuJoCo rendering (Great Lakes uses EGL for headless rendering)
export MUJOCO_GL="egl"
export PYOPENGL_PLATFORM="egl"
export MUJOCO_EGL_DEVICE_ID="0"

# Disable wandb (not using it)
export WANDB_DISABLED="true"

# Create directories if they don't exist
mkdir -p "${RVQ_DATA_DIR}"
mkdir -p "${RVQ_MODEL_DIR}"
mkdir -p "${RVQ_RESULTS_DIR}"
mkdir -p "${RVQ_LOG_DIR}"
mkdir -p "${HF_HOME}"

# Print confirmation
echo "RVQ environment variables set:"
echo "  RVQ_ROOT: ${RVQ_ROOT}"
echo "  Data: ${RVQ_DATA_DIR}"
echo "  Models: ${RVQ_MODEL_DIR}"
echo "  Results: ${RVQ_RESULTS_DIR}"
echo "  Logs: ${RVQ_LOG_DIR}"
if [ -n "${HF_TOKEN}" ]; then
    echo "  HF Token: loaded from ~/.hf_token"
fi
